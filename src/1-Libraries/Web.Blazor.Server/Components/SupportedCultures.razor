@using CodeBlock.DevKit.Web.Blazor.Server.Localization
@inject NavigationManager NavigationManager
@inject LocalizationSettings LocalizationSettings

<div class="btn-group">
    <button type="button" class="btn btn-danger dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
        @LocalizationSettings.GetLanguage(selectedLanguageCode)
    </button>
    <ul class="dropdown-menu">
        @foreach (var item in LocalizationSettings.Languages)
        {
            <li><a class="dropdown-item" href="/setculture?lang=@item.Code&returnUrl=/@ReturnUrl">@item.Name</a></li>
        }
    </ul>
</div>

@code {

    private string selectedLanguageCode;
    private string ReturnUrl;

    protected override void OnInitialized()
    {
        selectedLanguageCode = Thread.CurrentThread.CurrentCulture.Name;

        ReturnUrl = Uri.EscapeDataString(NavigationManager.ToBaseRelativePath(NavigationManager.Uri));
    }
}
